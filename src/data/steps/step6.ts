import { Step } from '../types';

export const step6: Step = {
  "id": "6",
  "title": "Mocking Functions - Creating and Controlling Test Doubles",
  "initialCode": "// ============================================\r\n// STEP 6: Mocking Functions\r\n// ============================================\r\n\r\n// Helper functions that use callbacks\r\nfunction forEach(items, callback) {\r\n  for (let i = 0; i < items.length; i++) {\r\n    callback(items[i], i);\r\n  }\r\n}\r\n\r\nfunction map(items, callback) {\r\n  const result = [];\r\n  for (let i = 0; i < items.length; i++) {\r\n    result.push(callback(items[i], i));\r\n  }\r\n  return result;\r\n}\r\n\r\nfunction filter(items, callback) {\r\n  const result = [];\r\n  for (let i = 0; i < items.length; i++) {\r\n    if (callback(items[i], i)) {\r\n      result.push(items[i]);\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\n// Async function that uses a callback\r\nasync function fetchData(callback) {\r\n  const data = await Promise.resolve('server data');\r\n  return callback(data);\r\n}\r\n\r\n// Retry logic function\r\nasync function retryOperation(fn, maxRetries) {\r\n  let lastError;\r\n  for (let i = 0; i < maxRetries; i++) {\r\n    try {\r\n      return await fn();\r\n    } catch (error) {\r\n      lastError = error;\r\n      if (i === maxRetries - 1) throw error;\r\n    }\r\n  }\r\n  throw lastError;\r\n}\r\n\r\n// ============================================\r\n// EXAMPLE 1: jest.fn() - Creating Mock Functions\r\n// ============================================\r\n\r\ntest('basic mock function', () => {\r\n  const mockFn = jest.fn();\r\n  \r\n  mockFn('hello');\r\n  mockFn('world');\r\n  \r\n  expect(mockFn).toHaveBeenCalled();\r\n  expect(mockFn).toHaveBeenCalledTimes(2);\r\n  expect(mockFn).toHaveBeenCalledWith('hello');\r\n  expect(mockFn).toHaveBeenCalledWith('world');\r\n});\r\n\r\ntest('mock function with forEach', () => {\r\n  const mockCallback = jest.fn();\r\n  \r\n  forEach([1, 2, 3], mockCallback);\r\n  \r\n  expect(mockCallback).toHaveBeenCalledTimes(3);\r\n  expect(mockCallback).toHaveBeenNthCalledWith(1, 1, 0);\r\n  expect(mockCallback).toHaveBeenNthCalledWith(2, 2, 1);\r\n  expect(mockCallback).toHaveBeenNthCalledWith(3, 3, 2);\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 2: Mock Return Values\r\n// ============================================\r\n\r\ntest('.mockReturnValue() - constant return', () => {\r\n  const mock = jest.fn().mockReturnValue(42);\r\n  \r\n  expect(mock()).toBe(42);\r\n  expect(mock()).toBe(42);\r\n  expect(mock()).toBe(42);\r\n});\r\n\r\ntest('.mockReturnValueOnce() - different returns', () => {\r\n  const mock = jest.fn()\r\n    .mockReturnValueOnce('first call')\r\n    .mockReturnValueOnce('second call')\r\n    .mockReturnValue('default');\r\n  \r\n  expect(mock()).toBe('first call');\r\n  expect(mock()).toBe('second call');\r\n  expect(mock()).toBe('default');\r\n  expect(mock()).toBe('default');\r\n});\r\n\r\ntest('mock with map function', () => {\r\n  const mockTransform = jest.fn()\r\n    .mockReturnValueOnce(1)\r\n    .mockReturnValueOnce(2)\r\n    .mockReturnValueOnce(3);\r\n  \r\n  const result = map(['a', 'b', 'c'], mockTransform);\r\n  \r\n  expect(result).toEqual([1, 2, 3]);\r\n  expect(mockTransform).toHaveBeenCalledTimes(3);\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 3: Mock Implementations\r\n// ============================================\r\n\r\ntest('.mockImplementation() - custom logic', () => {\r\n  const mock = jest.fn().mockImplementation((a, b) => a + b);\r\n  \r\n  expect(mock(1, 2)).toBe(3);\r\n  expect(mock(5, 7)).toBe(12);\r\n});\r\n\r\ntest('mock implementation shorthand', () => {\r\n  const mock = jest.fn((x) => x * 2);\r\n  \r\n  expect(mock(5)).toBe(10);\r\n  expect(mock(10)).toBe(20);\r\n});\r\n\r\ntest('.mockImplementationOnce() - varying behavior', () => {\r\n  const mock = jest.fn()\r\n    .mockImplementationOnce(() => 'first')\r\n    .mockImplementationOnce(() => 'second')\r\n    .mockImplementation(() => 'default');\r\n  \r\n  expect(mock()).toBe('first');\r\n  expect(mock()).toBe('second');\r\n  expect(mock()).toBe('default');\r\n  expect(mock()).toBe('default');\r\n});\r\n\r\ntest('mock with filter function', () => {\r\n  const mockPredicate = jest.fn((x) => x > 2);\r\n  \r\n  const result = filter([1, 2, 3, 4, 5], mockPredicate);\r\n  \r\n  expect(result).toEqual([3, 4, 5]);\r\n  expect(mockPredicate).toHaveBeenCalledTimes(5);\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 4: Async Mock Values\r\n// ============================================\r\n\r\ntest('.mockResolvedValue() - successful promise', async () => {\r\n  const mockAsync = jest.fn().mockResolvedValue('success');\r\n  \r\n  const result = await mockAsync();\r\n  expect(result).toBe('success');\r\n});\r\n\r\ntest('.mockResolvedValueOnce() - different results', async () => {\r\n  const mockAsync = jest.fn()\r\n    .mockResolvedValueOnce('first')\r\n    .mockResolvedValueOnce('second')\r\n    .mockResolvedValue('default');\r\n  \r\n  expect(await mockAsync()).toBe('first');\r\n  expect(await mockAsync()).toBe('second');\r\n  expect(await mockAsync()).toBe('default');\r\n});\r\n\r\ntest('.mockRejectedValue() - failed promise', async () => {\r\n  const mockAsync = jest.fn().mockRejectedValue(new Error('failed'));\r\n  \r\n  await expect(mockAsync()).rejects.toThrow('failed');\r\n});\r\n\r\ntest('async mock with fetchData', async () => {\r\n  const mockCallback = jest.fn().mockReturnValue('processed data');\r\n  \r\n  const result = await fetchData(mockCallback);\r\n  \r\n  expect(mockCallback).toHaveBeenCalledWith('server data');\r\n  expect(result).toBe('processed data');\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 5: Tracking Calls and Arguments\r\n// ============================================\r\n\r\ntest('accessing mock.calls', () => {\r\n  const mock = jest.fn();\r\n  \r\n  mock('a', 'b');\r\n  mock('c', 'd');\r\n  mock('e', 'f');\r\n  \r\n  // All calls\r\n  expect(mock.mock.calls).toEqual([\r\n    ['a', 'b'],\r\n    ['c', 'd'],\r\n    ['e', 'f']\r\n  ]);\r\n  \r\n  // Individual calls\r\n  expect(mock.mock.calls[0]).toEqual(['a', 'b']);\r\n  expect(mock.mock.calls[1]).toEqual(['c', 'd']);\r\n  expect(mock.mock.calls[2]).toEqual(['e', 'f']);\r\n  \r\n  // First argument of each call\r\n  expect(mock.mock.calls[0][0]).toBe('a');\r\n  expect(mock.mock.calls[1][0]).toBe('c');\r\n  expect(mock.mock.calls[2][0]).toBe('e');\r\n});\r\n\r\ntest('accessing mock.results', () => {\r\n  const mock = jest.fn()\r\n    .mockReturnValueOnce(10)\r\n    .mockReturnValueOnce(20)\r\n    .mockReturnValueOnce(30);\r\n  \r\n  mock();\r\n  mock();\r\n  mock();\r\n  \r\n  expect(mock.mock.results).toEqual([\r\n    { type: 'return', value: 10 },\r\n    { type: 'return', value: 20 },\r\n    { type: 'return', value: 30 }\r\n  ]);\r\n  \r\n  expect(mock.mock.results[0].value).toBe(10);\r\n  expect(mock.mock.results[1].value).toBe(20);\r\n});\r\n\r\ntest('tracking with complex data', () => {\r\n  const mockCallback = jest.fn((user) => `Hello ${user.name}`);\r\n  \r\n  mockCallback({ name: 'John', age: 30 });\r\n  mockCallback({ name: 'Jane', age: 25 });\r\n  \r\n  expect(mockCallback.mock.calls[0][0]).toEqual({ name: 'John', age: 30 });\r\n  expect(mockCallback.mock.results[0].value).toBe('Hello John');\r\n  expect(mockCallback.mock.results[1].value).toBe('Hello Jane');\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 6: Mock Assertions\r\n// ============================================\r\n\r\ntest('.toHaveBeenCalled()', () => {\r\n  const mock = jest.fn();\r\n  mock();\r\n  \r\n  expect(mock).toHaveBeenCalled();\r\n});\r\n\r\ntest('.toHaveBeenCalledTimes()', () => {\r\n  const mock = jest.fn();\r\n  mock();\r\n  mock();\r\n  mock();\r\n  \r\n  expect(mock).toHaveBeenCalledTimes(3);\r\n});\r\n\r\ntest('.toHaveBeenCalledWith()', () => {\r\n  const mock = jest.fn();\r\n  mock(1, 2, 3);\r\n  mock('a', 'b', 'c');\r\n  \r\n  expect(mock).toHaveBeenCalledWith(1, 2, 3);\r\n  expect(mock).toHaveBeenCalledWith('a', 'b', 'c');\r\n});\r\n\r\ntest('.toHaveBeenLastCalledWith()', () => {\r\n  const mock = jest.fn();\r\n  mock(1, 2);\r\n  mock(3, 4);\r\n  mock(5, 6);\r\n  \r\n  expect(mock).toHaveBeenLastCalledWith(5, 6);\r\n});\r\n\r\ntest('.toHaveBeenNthCalledWith()', () => {\r\n  const mock = jest.fn();\r\n  mock('first');\r\n  mock('second');\r\n  mock('third');\r\n  \r\n  expect(mock).toHaveBeenNthCalledWith(1, 'first');\r\n  expect(mock).toHaveBeenNthCalledWith(2, 'second');\r\n  expect(mock).toHaveBeenNthCalledWith(3, 'third');\r\n});\r\n\r\ntest('comprehensive assertion example', () => {\r\n  const mockCallback = jest.fn((x) => x * 2);\r\n  \r\n  const numbers = [1, 2, 3, 4];\r\n  numbers.forEach(mockCallback);\r\n  \r\n  // Called for each item\r\n  expect(mockCallback).toHaveBeenCalledTimes(4);\r\n  \r\n  // Called with each number\r\n  expect(mockCallback).toHaveBeenNthCalledWith(1, 1, 0, numbers);\r\n  expect(mockCallback).toHaveBeenNthCalledWith(2, 2, 1, numbers);\r\n  expect(mockCallback).toHaveBeenNthCalledWith(3, 3, 2, numbers);\r\n  expect(mockCallback).toHaveBeenNthCalledWith(4, 4, 3, numbers);\r\n  \r\n  // Last call\r\n  expect(mockCallback).toHaveBeenLastCalledWith(4, 3, numbers);\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 7: Accessing Mock Data\r\n// ============================================\r\n\r\ntest('detailed mock data inspection', () => {\r\n  const mock = jest.fn((x) => x * 2);\r\n  \r\n  mock(1);\r\n  mock(2);\r\n  mock(3);\r\n  \r\n  // Number of calls\r\n  expect(mock.mock.calls.length).toBe(3);\r\n  \r\n  // Arguments of each call\r\n  expect(mock.mock.calls[0][0]).toBe(1);\r\n  expect(mock.mock.calls[1][0]).toBe(2);\r\n  expect(mock.mock.calls[2][0]).toBe(3);\r\n  \r\n  // Return values\r\n  expect(mock.mock.results[0].value).toBe(2);\r\n  expect(mock.mock.results[1].value).toBe(4);\r\n  expect(mock.mock.results[2].value).toBe(6);\r\n  \r\n  // All results are type 'return' (not 'throw')\r\n  expect(mock.mock.results.every(r => r.type === 'return')).toBe(true);\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 8: Resetting and Clearing Mocks\r\n// ============================================\r\n\r\ntest('.mockClear() - clears history, keeps implementation', () => {\r\n  const mock = jest.fn().mockReturnValue(42);\r\n  \r\n  mock();\r\n  mock();\r\n  expect(mock).toHaveBeenCalledTimes(2);\r\n  expect(mock()).toBe(42);\r\n  \r\n  mock.mockClear();\r\n  \r\n  // Call history cleared\r\n  expect(mock).toHaveBeenCalledTimes(0);\r\n  // But implementation still works\r\n  expect(mock()).toBe(42);\r\n});\r\n\r\ntest('.mockReset() - clears everything', () => {\r\n  const mock = jest.fn().mockReturnValue(42);\r\n  \r\n  mock();\r\n  expect(mock()).toBe(42);\r\n  \r\n  mock.mockReset();\r\n  \r\n  // Call history cleared\r\n  expect(mock).toHaveBeenCalledTimes(0);\r\n  // Implementation removed\r\n  expect(mock()).toBeUndefined();\r\n});\r\n\r\ndescribe('clearing mocks in beforeEach', () => {\r\n  const mock = jest.fn();\r\n  \r\n  beforeEach(() => {\r\n    mock.mockClear();\r\n  });\r\n  \r\n  test('first test', () => {\r\n    mock();\r\n    expect(mock).toHaveBeenCalledTimes(1);\r\n  });\r\n  \r\n  test('second test starts fresh', () => {\r\n    expect(mock).toHaveBeenCalledTimes(0);\r\n  });\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 9: Testing Retry Logic\r\n// ============================================\r\n\r\ntest('retries until success', async () => {\r\n  const mockFn = jest.fn()\r\n    .mockRejectedValueOnce(new Error('First failure'))\r\n    .mockRejectedValueOnce(new Error('Second failure'))\r\n    .mockResolvedValue('Success!');\r\n  \r\n  const result = await retryOperation(mockFn, 3);\r\n  \r\n  expect(mockFn).toHaveBeenCalledTimes(3);\r\n  expect(result).toBe('Success!');\r\n});\r\n\r\ntest('throws after max retries', async () => {\r\n  const mockFn = jest.fn()\r\n    .mockRejectedValue(new Error('Always fails'));\r\n  \r\n  await expect(retryOperation(mockFn, 3)).rejects.toThrow('Always fails');\r\n  expect(mockFn).toHaveBeenCalledTimes(3);\r\n});\r\n\r\ntest('succeeds on first try', async () => {\r\n  const mockFn = jest.fn().mockResolvedValue('Immediate success');\r\n  \r\n  const result = await retryOperation(mockFn, 3);\r\n  \r\n  expect(mockFn).toHaveBeenCalledTimes(1);\r\n  expect(result).toBe('Immediate success');\r\n});\r\n\r\n// ============================================\r\n// EXAMPLE 10: Real-World Mock Scenario\r\n// ============================================\r\n\r\n// Simulated user service\r\nclass UserService {\r\n  constructor(apiClient) {\r\n    this.apiClient = apiClient;\r\n  }\r\n  \r\n  async createUser(userData) {\r\n    const response = await this.apiClient.post('/users', userData);\r\n    return response.data;\r\n  }\r\n  \r\n  async notifyUser(userId, message) {\r\n    await this.apiClient.post(`/users/${userId}/notify`, { message });\r\n  }\r\n}\r\n\r\ntest('UserService with mocked API client', async () => {\r\n  // Create mock API client\r\n  const mockApiClient = {\r\n    post: jest.fn()\r\n      .mockResolvedValueOnce({ data: { id: 1, name: 'John' } })\r\n      .mockResolvedValueOnce({ data: { success: true } })\r\n  };\r\n  \r\n  const service = new UserService(mockApiClient);\r\n  \r\n  // Create user\r\n  const user = await service.createUser({ name: 'John', email: 'john@example.com' });\r\n  expect(user).toEqual({ id: 1, name: 'John' });\r\n  expect(mockApiClient.post).toHaveBeenCalledWith('/users', {\r\n    name: 'John',\r\n    email: 'john@example.com'\r\n  });\r\n  \r\n  // Notify user\r\n  await service.notifyUser(1, 'Welcome!');\r\n  expect(mockApiClient.post).toHaveBeenCalledWith('/users/1/notify', {\r\n    message: 'Welcome!'\r\n  });\r\n  \r\n  expect(mockApiClient.post).toHaveBeenCalledTimes(2);\r\n});\n",
  "description": "## **Step 6: Mocking Functions**\r\n\r\n#### **Topic 1: jest.fn() - Creating Mock Functions**\r\n**Explanation:**\r\n`jest.fn()` creates a mock function (test double) that records how it was called. Use it to replace real functions in tests.\r\n\r\n**Syntax:**\r\n```javascript\r\nconst mockFn = jest.fn();\r\n```\r\n\r\n**Why mock?**\r\n- Isolate code being tested\r\n- Control function behavior\r\n- Track function calls\r\n- Test without side effects (API calls, DB queries)\r\n\r\n**Example:**\r\n```javascript\r\nconst mockCallback = jest.fn();\r\n[1, 2, 3].forEach(mockCallback);\r\n\r\nexpect(mockCallback).toHaveBeenCalledTimes(3);\r\nexpect(mockCallback).toHaveBeenCalledWith(1);\r\n```\r\n\r\n---\r\n\r\n#### **Topic 2: Mock Return Values (.mockReturnValue(), .mockReturnValueOnce())**\r\n**Explanation:**\r\n\r\n**`.mockReturnValue()`** - Sets a default return value for all calls\r\n```javascript\r\nconst mock = jest.fn();\r\nmock.mockReturnValue(42);\r\n\r\nconsole.log(mock()); // 42\r\nconsole.log(mock()); // 42\r\n```\r\n\r\n**`.mockReturnValueOnce()`** - Sets return value for one call, then falls back to default\r\n```javascript\r\nconst mock = jest.fn();\r\nmock.mockReturnValueOnce('first')\r\n    .mockReturnValueOnce('second')\r\n    .mockReturnValue('default');\r\n\r\nconsole.log(mock()); // 'first'\r\nconsole.log(mock()); // 'second'\r\nconsole.log(mock()); // 'default'\r\nconsole.log(mock()); // 'default'\r\n```\r\n\r\n---\r\n\r\n#### **Topic 3: Mock Implementations (.mockImplementation())**\r\n**Explanation:**\r\n\r\n**`.mockImplementation()`** - Replaces the function's implementation\r\n```javascript\r\nconst mock = jest.fn().mockImplementation((a, b) => a + b);\r\nconsole.log(mock(1, 2)); // 3\r\n\r\n// Shorthand\r\nconst mock2 = jest.fn((a, b) => a + b);\r\nconsole.log(mock2(2, 3)); // 5\r\n```\r\n\r\n**`.mockImplementationOnce()`** - For one call only\r\n```javascript\r\nconst mock = jest.fn()\r\n  .mockImplementationOnce(() => 'first')\r\n  .mockImplementationOnce(() => 'second')\r\n  .mockImplementation(() => 'default');\r\n```\r\n\r\n---\r\n\r\n#### **Topic 4: Async Mock Values (.mockResolvedValue(), .mockRejectedValue())**\r\n**Explanation:**\r\n\r\n**`.mockResolvedValue()`** - Mock function returns a resolved Promise\r\n```javascript\r\nconst mockAsync = jest.fn().mockResolvedValue('success');\r\nawait mockAsync(); // Returns Promise.resolve('success')\r\n```\r\n\r\n**`.mockResolvedValueOnce()`** - For one call\r\n```javascript\r\nconst mock = jest.fn()\r\n  .mockResolvedValueOnce('first')\r\n  .mockResolvedValueOnce('second')\r\n  .mockResolvedValue('default');\r\n```\r\n\r\n**`.mockRejectedValue()`** - Mock function returns a rejected Promise\r\n```javascript\r\nconst mockAsync = jest.fn().mockRejectedValue(new Error('failed'));\r\nawait mockAsync(); // Returns Promise.reject(new Error('failed'))\r\n```\r\n\r\n---\r\n\r\n#### **Topic 5: Tracking Calls and Arguments**\r\n**Explanation:**\r\nMock functions automatically track how they were called.\r\n\r\n**`.mock.calls`** - Array of argument arrays for each call\r\n```javascript\r\nconst mock = jest.fn();\r\nmock(1, 2);\r\nmock(3, 4);\r\n\r\nconsole.log(mock.mock.calls);\r\n// [[1, 2], [3, 4]]\r\n\r\nconsole.log(mock.mock.calls[0]); // [1, 2]\r\nconsole.log(mock.mock.calls[1]); // [3, 4]\r\n```\r\n\r\n**`.mock.results`** - Array of return values/errors\r\n```javascript\r\nconst mock = jest.fn()\r\n  .mockReturnValueOnce('a')\r\n  .mockReturnValueOnce('b');\r\n\r\nmock();\r\nmock();\r\n\r\nconsole.log(mock.mock.results);\r\n// [\r\n//   { type: 'return', value: 'a' },\r\n//   { type: 'return', value: 'b' }\r\n// ]\r\n```\r\n\r\n**`.mock.instances`** - Array of `this` values\r\n```javascript\r\nconst MockClass = jest.fn();\r\nconst a = new MockClass();\r\nconst b = new MockClass();\r\n\r\nconsole.log(MockClass.mock.instances); // [a, b]\r\n```\r\n\r\n---\r\n\r\n#### **Topic 6: Mock Assertions**\r\n**Explanation:**\r\n\r\n**`.toHaveBeenCalled()`** - Asserts function was called at least once\r\n```javascript\r\nconst mock = jest.fn();\r\nmock();\r\nexpect(mock).toHaveBeenCalled();\r\n```\r\n\r\n**`.toHaveBeenCalledTimes(n)`** - Asserts exact number of calls\r\n```javascript\r\nconst mock = jest.fn();\r\nmock();\r\nmock();\r\nexpect(mock).toHaveBeenCalledTimes(2);\r\n```\r\n\r\n**`.toHaveBeenCalledWith(...args)`** - Asserts called with specific arguments\r\n```javascript\r\nconst mock = jest.fn();\r\nmock(1, 2, 3);\r\nexpect(mock).toHaveBeenCalledWith(1, 2, 3);\r\n```\r\n\r\n**`.toHaveBeenLastCalledWith(...args)`** - Asserts last call arguments\r\n```javascript\r\nconst mock = jest.fn();\r\nmock(1, 2);\r\nmock(3, 4);\r\nexpect(mock).toHaveBeenLastCalledWith(3, 4);\r\n```\r\n\r\n**`.toHaveBeenNthCalledWith(n, ...args)`** - Asserts nth call arguments\r\n```javascript\r\nconst mock = jest.fn();\r\nmock(1, 2);\r\nmock(3, 4);\r\nexpect(mock).toHaveBeenNthCalledWith(1, 1, 2); // First call\r\nexpect(mock).toHaveBeenNthCalledWith(2, 3, 4); // Second call\r\n```\r\n\r\n---\r\n\r\n#### **Topic 7: Accessing Mock Data (.mock.calls, .mock.results)**\r\n**Explanation:**\r\nDirectly inspect mock function data for advanced assertions.\r\n\r\n```javascript\r\nconst mock = jest.fn((x) => x * 2);\r\nmock(1);\r\nmock(2);\r\nmock(3);\r\n\r\n// Access all calls\r\nexpect(mock.mock.calls.length).toBe(3);\r\nexpect(mock.mock.calls[0][0]).toBe(1);\r\nexpect(mock.mock.calls[1][0]).toBe(2);\r\n\r\n// Access all results\r\nexpect(mock.mock.results[0].value).toBe(2);\r\nexpect(mock.mock.results[1].value).toBe(4);\r\nexpect(mock.mock.results[2].value).toBe(6);\r\n```\r\n\r\n---\r\n\r\n#### **Topic 8: Resetting and Clearing Mocks**\r\n**Explanation:**\r\n\r\n**`.mockClear()`** - Clears call history and results, keeps implementation\r\n```javascript\r\nconst mock = jest.fn().mockReturnValue(42);\r\nmock();\r\nexpect(mock).toHaveBeenCalledTimes(1);\r\n\r\nmock.mockClear();\r\nexpect(mock).toHaveBeenCalledTimes(0);\r\nconsole.log(mock()); // Still returns 42\r\n```\r\n\r\n**`.mockReset()`** - Clears everything AND removes implementation\r\n```javascript\r\nconst mock = jest.fn().mockReturnValue(42);\r\nmock.mockReset();\r\nconsole.log(mock()); // undefined (implementation removed)\r\n```\r\n\r\n**`.mockRestore()`** - Restores original implementation (only for spies)\r\n```javascript\r\nconst original = jest.spyOn(obj, 'method');\r\nobj.method.mockRestore(); // Restores original method\r\n```\r\n\r\n---\r\n\r\n#### **Topic 9: Testing Retry Logic with Mocks**\r\n**Explanation:**\r\nUse mocks to test retry mechanisms by controlling success/failure.\r\n\r\n```javascript\r\nfunction retry(fn, times) {\r\n  return fn().catch(err => {\r\n    if (times === 1) throw err;\r\n    return retry(fn, times - 1);\r\n  });\r\n}\r\n\r\ntest('retries 3 times before succeeding', async () => {\r\n  const mockFn = jest.fn()\r\n    .mockRejectedValueOnce(new Error('fail'))\r\n    .mockRejectedValueOnce(new Error('fail'))\r\n    .mockResolvedValue('success');\r\n  \r\n  const result = await retry(mockFn, 3);\r\n  \r\n  expect(mockFn).toHaveBeenCalledTimes(3);\r\n  expect(result).toBe('success');\r\n});\r\n```"
};
